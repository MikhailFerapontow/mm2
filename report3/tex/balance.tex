\subsection{Разностная схема}
Введем основную сетку:
\begin{align*}
  &N_r - \text{число разбиений на} [0, R] & &N_z - \text{число разбиений на} [0, L] \\
  &r_0 < r_1 < \cdots < r_N & &z_0 < z_1 < \cdots < z_N \\
  &r_0 = 0,\quad r_N = R & &z_0 = 0,\quad z_N = L \\
  &h_i = \frac{R - 0}{N_r},\quad i=0,\cdots, N_r & &h_j = \frac{L - 0}{N_z},\quad j=0,\cdots, N_z 
\end{align*}

Введем дополнительную сетку:
\begin{align*}
  &r_{i-\frac{1}{2}} = \frac{r_i + r_{i - 1}}{2}\quad i=1,\cdots, N_r & &z_{j-\frac{1}{2}} = \frac{z_j + z_{j - 1}}{2}\quad j=1,\cdots, N_z \\
  &  \hbar_i = \begin{cases}
    \frac{h_i + 1}{2},\ i = 0 \\ \\
    \frac{h_i + h_{i+1}}{2},\ i = 1, 2, \dots, N_r-1 \\ \\
    \frac{h_i}{2},\ i = N_r
  \end{cases} &
  &   \hbar_j = \begin{cases}
    \frac{h_j + 1}{2},\ j = 0 \\ \\
    \frac{h_j + h_{j+1}}{2},\ j = 1, 2, \dots, N_z-1 \\ \\
    \frac{h_j}{2},\ j = N_z
  \end{cases}
\end{align*}

Преобразуем наше начальное уравнение

\[
  - \left [ \pdv{}{r} \left ( r k_1(r, z) \pdv{u}{r} \right ) 
  + \pdv{}{z} \left ( rk_2(r, z)\pdv{u}{v} \right ) \right ] = rf(r, z)
\]

Проинтегрируем уравнение внутри интервала:

\[
  - \mLim{+\frac{1}{2}}{-\frac{1}{2}}{+\frac{1}{2}}{-\frac{1}{2}} \left [ \pdv{}{r} \left ( r k_1(r, z) \pdv{u}{r} \right ) 
  + \pdv{}{z} \left ( rk_2(r, z)\pdv{u}{v} \right ) \right ] dr dz = \mLim{+\frac{1}{2}}{-\frac{1}{2}}{+\frac{1}{2}}{-\frac{1}{2}} rf(r, z) dr dz
\]

Получим:

\begin{align*}
  &- \left [
   \mLimS{z}{+\frac{1}{2}}{-\frac{1}{2}}  \left . r k_1(r, z) \pdv{u}{r} \right \vert_{r = r_{i + \frac{1}{2}}} dz
  - \mLimS{z}{+\frac{1}{2}}{-\frac{1}{2}} \left . r k_1(r, z) \pdv{u}{r} \right \vert_{r = r_{i - \frac{1}{2}}} dz
  \right . \\
  &\left . + \mLimS{r}{+\frac{1}{2}}{-\frac{1}{2}} \left . rk_2(r, z)\pdv{u}{v} \right \vert_{z = z_{j + \frac{1}{2}}} dr
  - \mLimS{r}{+\frac{1}{2}}{-\frac{1}{2}} \left . rk_2(r, z)\pdv{u}{v} \right \vert_{z = z_{j - \frac{1}{2}}} dr
  \right ] = \mLim{+\frac{1}{2}}{-\frac{1}{2}}{+\frac{1}{2}}{-\frac{1}{2}} rf(r, z) dr dz
\end{align*}

Воспользуемся формулами численного дифференцирования:
\[
  \left . k_1(r, z) \pdv{u}{r} \right \vert_{r = r_{i - \frac{1}{2}}}
  \approx k_1(r_{i - \frac{1}{2}}, z) 
  \frac{v_{i, j} - v_{i - 1, j}}{h_i}
\]

\[
  \left . k_2(r, z) \pdv{u}{r} \right \vert_{z = z_{j - \frac{1}{2}}}
  \approx k_2(r, z_{j - \frac{1}{2}}) 
  \frac{v_{i, j} - v_{i, j - 1}}{h_j}
\]

Также воспользуемся формулой средних прямоугольников:
\[
  \mLimS{r}{+\frac{1}{2}}{-\frac{1}{2}} r \varphi(r, z) dr
  = \hbar_i r_i \varphi_i
\]
\[
  \mLim{+\frac{1}{2}}{-\frac{1}{2}}{+\frac{1}{2}}{-\frac{1}{2}} r \varphi(r, z) drdz
  = \hbar_i\hbar_j r_i \varphi_{i, j}
\]

В итоге получаем разностную схему внутри интервала:
\begin{align*}
  - \left [ 
  \hbar_j r_{i+\frac{1}{2}} k_1(r_{i+\frac{1}{2}}, z_j) \frac{v_{i+1, j} - v_{i, j}}{h_{i + 1}}
  - \hbar_j r_{i-\frac{1}{2}} k_1(r_{i-\frac{1}{2}}, z_j) \frac{v_{i, j} - v_{i - 1, j}}{h_{i}}
  \right . \\
  \left .
  + \hbar_i r_{i+\frac{1}{2}} k_2(r_i, z_{j+\frac{1}{2}}) \frac{v_{i, j + 1} - v_{i, j}}{h_{j + 1}}
  - \hbar_i r_{i-\frac{1}{2}} k_2(r_i, z_{j-\frac{1}{2}}) \frac{v_{i, j} - v_{i, j - 1}}{h_j}
  \right ]  = \hbar_i \hbar_j r_i f_{i, j}
\end{align*}

Теперь найдем значение разностной схемы на углах и границах интервалов

\subsubsection{На левой границе}

Проинтегрируем наше уравнение в $ i = 0 $ и $ z $ внутри промежутка
\[
  - \mLim{+\frac{1}{2}}{}{+\frac{1}{2}}{-\frac{1}{2}} \left [ \pdv{}{r} \left ( r k_1(r, z) \pdv{u}{r} \right ) 
  + \pdv{}{z} \left ( rk_2(r, z)\pdv{u}{v} \right ) \right ] dr dz = \mLim{+\frac{1}{2}}{}{+\frac{1}{2}}{-\frac{1}{2}} rf(r, z) dr dz
\]

Получаем:
\begin{align*}
  - \left [
   \mLimS{z}{+\frac{1}{2}}{-\frac{1}{2}}  \left . r k_1(r, z) \pdv{u}{r} \right \vert_{r = r_{i + \frac{1}{2}}} dz
  - \mLimS{z}{+\frac{1}{2}}{-\frac{1}{2}} \left . r k_1(r, z) \pdv{u}{r} \right \vert_{r = r_{i}} dz
  \right . \\
  \left . + \mLimS{r}{+\frac{1}{2}}{} \left . rk_2(r, z)\pdv{u}{v} \right \vert_{z = z_{j + \frac{1}{2}}} dr
  - \mLimS{r}{+\frac{1}{2}}{} \left . rk_2(r, z)\pdv{u}{v} \right \vert_{z = z_{j - \frac{1}{2}}} dr
  \right ] = \mLim{+\frac{1}{2}}{}{+\frac{1}{2}}{-\frac{1}{2}} rf(r, z) dr dz
\end{align*}

Имеем граничное условие:
\[
  \left . u \right \vert_{r=0} - \text{ограничено, т. е } \left . \frac{\partial u}{ \partial r} \right |_{r = 0} = 0
\]

\[
  \mLimS{r}{+ \frac{1}{2}}{} rf dr \approx f_i \mLimS{r}{ + \frac{1}{2}}{} r dr = 
  f_i \frac{r^2_{i + \frac{1}{2}}}{2} = h_r f_i \frac{r_{i + \frac{1}{2}}}{2},
  \quad i = 0, \quad r_i = 0, r_{i + \frac{1}{2}} = \frac{h_r}{2}
\]


Получаем разностную схему:
\begin{align*}
  &- \left [ 
  \hbar_j r_{i+\frac{1}{2}} k_1(r_{i+\frac{1}{2}}, z_j) \frac{v_{i+1, j} - v_{i, j}}{h_{i + 1}}
  - 0
  \right . \\
  &\left .
  + \hbar_i r_{i+\frac{1}{2}} k_2(r_i, z_{j+\frac{1}{2}}) \frac{v_{i, j + 1} - v_{i, j}}{h_{j + 1}}
  - \hbar_i r_{i-\frac{1}{2}} k_2(r_i, z_{j-\frac{1}{2}}) \frac{v_{i, j} - v_{i, j - 1}}{h_j}
  \right ]  = \hbar_i \hbar_j r_i f_{i, j}
\end{align*}

\subsubsection{На правой границе}
Проинтегрируем наше уравнение в $ i = N_x $ и $ z $ внутри промежутка
\[
  - \mLim{}{-\frac{1}{2}}{+\frac{1}{2}}{-\frac{1}{2}} \left [ \pdv{}{r} \left ( r k_1(r, z) \pdv{u}{r} \right ) 
  + \pdv{}{z} \left ( rk_2(r, z)\pdv{u}{v} \right ) \right ]dr dz = \mLim{}{-\frac{1}{2}}{+\frac{1}{2}}{-\frac{1}{2}} rf(r, z)dr dz
\]

Получаем:
\begin{align*}
  &- \left [
   \mLimS{z}{+\frac{1}{2}}{-\frac{1}{2}}  \left . r k_1(r, z) \pdv{u}{r} \right \vert_{r = r_{i}} dz
  - \mLimS{z}{+\frac{1}{2}}{-\frac{1}{2}} \left . r k_1(r, z) \pdv{u}{r} \right \vert_{r = r_{i - \frac{1}{2}}} dz
  \right . \\
  &\left . + \mLimS{r}{}{-\frac{1}{2}} \left . rk_2(r, z)\pdv{u}{v} \right \vert_{z = z_{j + \frac{1}{2}}} dr
  - \mLimS{r}{}{-\frac{1}{2}} \left . rk_2(r, z)\pdv{u}{v} \right \vert_{z = z_{j - \frac{1}{2}}} dr
  \right ] = \mLim{}{-\frac{1}{2}}{+\frac{1}{2}}{-\frac{1}{2}} rf(r, z) dr dz
\end{align*}

Имеем граничное условие:
\[
  \left . -k_1 \pdv{u}{r} \right \vert_{r=R} = \chi_2 \left . u \right \vert_{r=R} - \varphi_2(z)
\]

Получаем разностную схему:
\begin{align*}
  &- \left [ 
  -\hbar_j ( \chi_2 v_i - \varphi_2(z))
  - \hbar_j r_{i-\frac{1}{2}} k_1(r_{i-\frac{1}{2}}, z_j) \frac{v_{i, j} - v_{i - 1, j}}{h_{i}}
  \right . \\
  &\left .
  + \hbar_i r_{i+\frac{1}{2}} k_2(r_i, z_{j+\frac{1}{2}}) \frac{v_{i, j + 1} - v_{i, j}}{h_{j + 1}}
  - \hbar_i r_{i-\frac{1}{2}} k_2(r_i, z_{j-\frac{1}{2}}) \frac{v_{i, j} - v_{i, j - 1}}{h_j}
  \right ]  = \hbar_i \hbar_j r_i f_{i, j}
\end{align*}

\subsubsection{На нижней границе}
Проинтегрируем наше уравнение $ j = 0 $ и $ i $ внутри промежутка
\[
  - \mLim{+\frac{1}{2}}{-\frac{1}{2}}{+\frac{1}{2}}{} \left [ \pdv{}{r} \left ( r k_1(r, z) \pdv{u}{r} \right ) 
  + \pdv{}{z} \left ( rk_2(r, z)\pdv{u}{v} \right ) \right ] drdz = \mLim{+\frac{1}{2}}{-\frac{1}{2}}{+\frac{1}{2}}{} rf(r, z) dr dz
\]

Получаем:
\begin{align*}
  &- \left [
   \mLimS{z}{+\frac{1}{2}}{}  \left . r k_1(r, z) \pdv{u}{r} \right \vert_{r = r_{i + \frac{1}{2}}} dz
  - \mLimS{z}{+\frac{1}{2}}{} \left . r k_1(r, z) \pdv{u}{r} \right \vert_{r = r_{i - \frac{1}{2}}} dz
  \right . \\
  &\left . + \mLimS{r}{+\frac{1}{2}}{-\frac{1}{2}} \left . rk_2(r, z)\pdv{u}{v} \right \vert_{z = z_{j + \frac{1}{2}}} dr
  - \mLimS{r}{+\frac{1}{2}}{-\frac{1}{2}} \left . rk_2(r, z)\pdv{u}{v} \right \vert_{z = z_{j}} dr
  \right ] = \mLim{+\frac{1}{2}}{-\frac{1}{2}}{+\frac{1}{2}}{} rf(r, z) dr dz
\end{align*}

Имеем граничное условие:
\[
  \left . k_2 \pdv{u}{z} \right \vert_{z=0} = \chi_3 \left . u \right \vert_{z=0} - \varphi_3(r)
\]

Получаем разностную схему:
\begin{align*}
  - \left [ 
  \hbar_j r_{i+\frac{1}{2}} k_1(r_{i+\frac{1}{2}}, z_j) \frac{v_{i+1, j} - v_{i, j}}{h_{i + 1}}
  - \hbar_j r_{i-\frac{1}{2}} k_1(r_{i-\frac{1}{2}}, z_j) \frac{v_{i, j} - v_{i - 1, j}}{h_{i}}
  \right . \\
  \left .
  + \hbar_i r_{i+\frac{1}{2}} k_2(r_i, z_{j+\frac{1}{2}}) \frac{v_{i, j + 1} - v_{i, j}}{h_{j + 1}}
  - \hbar_i(\chi_3 v_i - \varphi_3(r))
  \right ]  = \hbar_i \hbar_j r_i f_{i, j}
\end{align*}

\subsubsection{На верхней границе}
Имеем граничное условие:
\[
  \left . u \right \vert_{z=L} = \varphi_r(r) 
\]

\subsubsection{Правый-нижний угол}

Проинегрируем наше уравнение
\[
  - \mLim{}{-\frac{1}{2}}{+\frac{1}{2}}{} \left [ \pdv{}{r} \left ( r k_1(r, z) \pdv{u}{r} \right ) 
  + \pdv{}{z} \left ( rk_2(r, z)\pdv{u}{v} \right ) \right ] = \mLim{}{-\frac{1}{2}}{+\frac{1}{2}}{} rf(r, z)
\]

Получаем:

\begin{align*}
  &- \left [
   \mLimS{z}{+\frac{1}{2}}{}  \left . r k_1(r, z) \pdv{u}{r} \right \vert_{r = r_i} dz
  - \mLimS{z}{+\frac{1}{2}}{} \left . r k_1(r, z) \pdv{u}{r} \right \vert_{r = r_{i - \frac{1}{2}}} dz
  \right . \\
  &\left . + \mLimS{r}{}{-\frac{1}{2}} \left . rk_2(r, z)\pdv{u}{v} \right \vert_{z = z_{j + \frac{1}{2}}} dr
  - \mLimS{r}{}{-\frac{1}{2}} \left . rk_2(r, z)\pdv{u}{v} \right \vert_{z = z_{j}} dr
  \right ] = \mLim{}{-\frac{1}{2}}{+\frac{1}{2}}{} rf(r, z) dr dz
\end{align*}

Имеем граничные условия:

\begin{align*}
  &\left . -k_1 \pdv{u}{r} \right \vert_{r=R} = \chi_2 \left . u \right \vert_{r=R} - \varphi_2(z) \\
  &\left . k_2 \pdv{u}{z} \right \vert_{z=0} = \chi_3 \left . u \right \vert_{z=0} - \varphi_3(r) 
\end{align*}

Получаем разностную схему:

\begin{align*}
  - \left [ 
  -\hbar_j (\chi_2 \left . u \right \vert_{r=R} - \varphi_2(z) )
  - \hbar_j r_{i-\frac{1}{2}} k_1(r_{i-\frac{1}{2}}, z_j) \frac{v_{i, j} - v_{i - 1, j}}{h_{i}}
  \right . \\
  \left .
  + \hbar_i r_{i+\frac{1}{2}} k_2(r_i, z_{j+\frac{1}{2}}) \frac{v_{i, j + 1} - v_{i, j}}{h_{j + 1}}
  - \hbar_i(\chi_3 v_i - \varphi_3(r))
  \right ]  = \hbar_i \hbar_j r_i f_{i, j}
\end{align*}

Другие углы нам известны.

% \subsubsection{Правый-верхний угол}
% \[
%   - \mLim{}{-\frac{1}{2}}{}{-\frac{1}{2}} \left [ \pdv{}{r} \left ( r k_1(r, z) \pdv{u}{r} \right ) 
%   + \pdv{}{z} \left ( rk_2(r, z)\pdv{u}{v} \right ) \right ] = \mLim{}{-\frac{1}{2}}{}{-\frac{1}{2}} rf(r, z)
% \]
