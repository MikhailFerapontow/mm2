\section{Тестирование}

Протестируем постренную модель на следующих тестовых наборах:

\begin{center}
  \begin{tabular}{*4{c}}
  \toprule
  \makecell{№ \\ теста} & $k_1(r, z)$ & $k_2(r, z)$ & $ u(r, z)$ \\
  \midrule
  1 & $ x + y + 3 $ & $ x + y + 3 $ & $1$ \\
  2 & $ 3x + 2y + 1 $ & $ 3x + 2y + 1 $ & $x^2$ \\
  3 & $ (x + y + 3)^2 $ & $ (x + y + 3)^2 $ & $(x + 2y)^2$ \\
  4 & $ (x + 2y + 3)^3 $ & $ (x + 2y + 3)^3 $ & $x^3 + y^2$ \\
  \bottomrule
  \end{tabular}
\end{center}

Все тесты имеют общие значения:

\[
  r \in [0, 1],\quad z \in [0, 2]
\]

\[
  \xi_2 = 2,\quad \xi_3 = 3
\]

Погрешность решения задачи вычисляется следующим образом:
\[
\delta_1 = \frac{\left|| x - \Tilde{x} \right||_1 }{\left|| x \right||_1 }
\]

\[
\delta_2 = \frac{\left|| x - \Tilde{x} \right||_2 }{\left|| x \right||_2 }
\]

\[
\delta_3 = \frac{\left|| x - \Tilde{x} \right||_\infty }{\left|| x \right||_\infty }
\]

Значение $ \varepsilon $ для метода сопряжённых градиентов равно $ 10^{-8} $.

\subsubsection*{Тест №1}

Имеем лишь ошибку округления.

\begin{table}[H]
\begin{center}
  \begin{tabular}{*{6}c}
    \toprule
    $ N_r $ & $ N_z $ & n & $ \delta_1 $ & $ \delta_2 $ & $ \delta_3 $ \\
    \midrule
    2 & 2 & 8 & $4.324e-16 $ & $7.63e-16 $ & $4.064e-16 $ \\
    4 & 4 & 27 & $2.514e-11 $ & $2.419e-11 $ & $2.88e-11 $ \\
    8 & 8 & 62 & $1.354e-10 $ & $1.284e-10 $ & $1.868e-10 $ \\
    16 & 16 & 117 & $2.3e-10 $ & $6.527e-10 $ & $1.151e-10 $ \\
    32 & 32 & 306 & $5.921e-09 $ & $1.849e-09 $ & $4.102e-09 $ \\
    \bottomrule
  \end{tabular}
  \caption{Явный метод}
\end{center}
\end{table}

\begin{table}[H]
  \begin{center}
    \begin{tabular}{*{6}c}
      \toprule
      $ N_r $ & $ N_z $ & n & $ \delta_1 $ & $ \delta_2 $ & $ \delta_3 $ \\
      \midrule
      2 & 2 & 5 & $ 9.509e-16 $ & $ 4.186e-16 $ & $ 9.29e-16 $ \\
      4 & 4 & 9 & $2.395e-11 $ & $2.574e-11 $ & $4.137e-11 $ \\
      8 & 8 & 15 & $ 1.62e-10 $ & $2.34e-10 $ & $1.97e-10 $ \\
      16 & 16 & 25 & $6.74e-10$ & $9.82e-10 $ & $2.23e-10 $ \\
      32 & 32 & 46 & $1.12e-9 $ & $1.59e-9 $ & $3.37e-9 $ \\
      \bottomrule
    \end{tabular}
    \caption{Неявный метод}
  \end{center}
\end{table}

\subsubsection*{Тест №2}

Присутствует ошибка округления и ошибка аппроксимации.

\begin{table}[H]
  \begin{center}
    \begin{tabular}{*{6}c}
      \toprule
      $ N_r $ & $ N_z $ & n & $ \delta_1 $ & $ \delta_2 $ & $ \delta_3 $ \\
      \midrule
      2 & 2 & 8 & $3.471e-4 $ & $4.164e-4 $ & $7.953e-4 $ \\
      4 & 4 & 21 & $8.689e-5 $ & $1.041e-4 $ & $1.986e-4 $ \\
      8 & 8 & 55 & $2.181e-5 $ & $2.624e-5 $ & $4.971e-5 $ \\
      16 & 16 & 107 & $5.378e-6 $ & $6.47e-6 $ & $1.249e-5 $ \\
      32 & 32 & 208 & $1.485e-6 $ & $1.589e-6 $ & $3.136e-6 $ \\
      \bottomrule
    \end{tabular}
    \caption{Явный метод}
  \end{center}
  \end{table}
  
  \begin{table}[H]
    \begin{center}
      \begin{tabular}{*{6}c}
        \toprule
        $ N_r $ & $ N_z $ & n & $ \delta_1 $ & $ \delta_2 $ & $ \delta_3 $ \\
        \midrule
        2 & 2 & 5 & $3.471e-4 $ & $4.164e-4 $ & $7.953e-4 $  \\
        4 & 4 & 8 & $8.689e-5 $ & $1.041e-4 $ & $1.986e-4 $ \\
        8 & 8 & 14 & $2.181e-5 $ & $2.624e-5 $ & $4.971e-5 $ \\
        16 & 16 & 27 & $5.378e-6 $ & $6.47e-6 $ & $1.249e-5 $ \\
        32 & 32 & 44 & $1.485e-6 $ & $1.589e-6 $ & $3.136e-6 $ \\
        \bottomrule
      \end{tabular}
      \caption{Неявный метод}
    \end{center}
  \end{table}

\subsubsection*{Тест №3}

Присутствует ошибка округления и ошибка аппроксимации.

\begin{table}[H]
  \begin{center}
    \begin{tabular}{*{6}c}
      \toprule
      $ N_r $ & $ N_z $ & n & $ \delta_1 $ & $ \delta_2 $ & $ \delta_3 $ \\
      \midrule
      2 & 2 & 7 & $6.74e-2 $ & $7.374e-2 $ & $6.27e-2 $ \\
      4 & 4 & 22 & $1.989e-2 $ & $1.842e-2 $ & $1.566e-2 $ \\
      8 & 8 & 41 & $4.975e-3 $ & $4.587e-3 $ & $3.918e-3 $ \\
      16 & 16 & 163& $1.214e-3 $ & $1.11e-3 $ & $9.937e-4 $ \\
      32 & 32 & 269 & $3.256e-4 $ & $2.976e-4 $ & $2.232e-4 $ \\
      \bottomrule
    \end{tabular}
    \caption{Явный метод}
  \end{center}
\end{table}
  
\begin{table}[H]
  \begin{center}
    \begin{tabular}{*{6}c}
      \toprule
      $ N_r $ & $ N_z $ & n & $ \delta_1 $ & $ \delta_2 $ & $ \delta_3 $ \\
      \midrule
      2 & 2 & 5 & $6.74e-2 $ & $7.374e-2 $ & $6.27e-2 $  \\
      4 & 4 & 8 & $1.989e-2 $ & $1.842e-2 $ & $1.566e-2 $ \\
      8 & 8 & 15 & $4.975e-3 $ & $4.587e-3 $ & $3.918e-3 $ \\
      16 & 16 & 25 & $1.214e-3 $ & $1.11e-3 $ & $9.937e-4 $ \\
      32 & 32 & 47 & $3.256e-4 $ & $2.976e-4 $ & $2.232e-4 $ \\
      \bottomrule
    \end{tabular}
    \caption*{Неявный метод}
  \end{center}
\end{table}

\subsubsection*{Тест №4}

Присутствует ошибка округления и ошибка аппроксимации.

\begin{table}[H]
  \begin{center}
    \begin{tabular}{*{6}c}
      \toprule
      $ N_r $ & $ N_z $ & n & $ \delta_1 $ & $ \delta_2 $ & $ \delta_3 $ \\
      \midrule
      2 & 2 & 7 & $1.074e-1 $ & $9.374e-2 $ & $1.28e-1 $ \\
      4 & 4 & 22 & $2.7029e-2 $ & $2.4e-3 $ & $3.176e-2 $ \\
      8 & 8 & 41 & $6.64e-3 $ & $6.036e-3 $ & $8.085e-3 $ \\
      16 & 16 & 107 & $1.568e-3 $ & $1.491e-3 $ & $1.78e-3 $ \\
      32 & 32 & 246 & $4.755e-4 $ & $3.628e-4 $ & $5.098e-4 $ \\
      \bottomrule
    \end{tabular}
    \caption{Явный метод}
  \end{center}
\end{table}
  
\begin{table}[H]
  \begin{center}
    \begin{tabular}{*{6}c}
      \toprule
      $ N_r $ & $ N_z $ & n & $ \delta_1 $ & $ \delta_2 $ & $ \delta_3 $ \\
      \midrule
      2 & 2 & 4 & $1.074e-1 $ & $9.374e-2 $ & $1.28e-1 $ \\
      4 & 4 & 7 & $2.7029e-2 $ & $2.4e-3 $ & $3.176e-2 $ \\
      8 & 8 & 17 & $6.64e-3 $ & $6.036e-3 $ & $8.085e-3 $ \\
      16 & 16 & 29 & $1.568e-3 $ & $1.491e-3 $ & $1.78e-3 $ \\
      32 & 32 & 51 & $4.755e-4 $ & $3.628e-4 $ & $5.098e-4 $ \\
      \bottomrule
    \end{tabular}
    \caption{Неявный метод}
  \end{center}
\end{table}

По значениям наших тестов можно сделать следующие выводы:
\begin{itemize}
  \item Неявный метод имеет значительно большую скорость сходимости.
  \item Увеличение числа разбиений в два раза приводит к уменьшению погрешности примерно в четыре раза при наличии ошибки аппроксимации.
\end{itemize}